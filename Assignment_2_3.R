# Q3, 5.7
age=c(70:75)
ecx=c(1000,1500,1010,1008,1006,998)
dx=c(80,90,95,105,115,125)
crude=dx/ecx
logcrude=log(crude)

f=function(theta){
  sum(-ecx*theta[1]*theta[2]^age+dx*log(ecx*theta[1]*theta[2]^age)-log(factorial(dx)))
}
nlm(f,p=c(-1,1))

# Q3, 5.8
age2=c(30:49)
ex2=c(70000,66672,68375,65420,61779,66091,68514,69560,65000,66279,67300,65368,65391,62917,66537,62320,62145,63856,61907,61110)
dx2=c(39,43,34,31,23,50,48,43,48,47,62,63,84,86,120,121,122,162,151,184)


# Q3, 5.9
age3=c(47:67)
ex3=c(166,187,218,243,276,302,347,390,430,494,558,628,701,813,917,1040,1182,1299,1432,1596,1752)
dx3=c(2,2,4,6,2,4,7,3,9,9,8,11,14,18,18,24,30,43,41,54,64)
stdtableqx=c(0.00505,0.0057,0.00644,0.00728,0.00826,0.0093,0.01051,0.01184,0.01331,0.01492,0.01668,0.01859,0.02065,0.02287,0.02525,0.02778,0.03049,0.03339,0.03648,0.03978,0.04332)


